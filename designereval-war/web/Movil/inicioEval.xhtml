<?xml version='1.0' encoding='ISO-8859-1' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pm="http://primefaces.org/mobile"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <f:view renderKitId="PRIMEFACES_MOBILE" />

    <h:head>
        <link rel="stylesheet" href="./resources/css/estilosPersonalizados.css"/>
    </h:head>
    <h:body>
        <h:form id="principalForm">
            <p:remoteCommand name="seleccionConvocatoria" actionListener="#{controladorInicioEval.seleccionConvocatoria(1)}"
                             update="evaluados"
                             oncomplete="PrimeFaces.Mobile.navigate('#evaluados', {transition: 'flip'}); return false;"/>
            <p:remoteCommand name="seleccionEvaluado" actionListener="#{controladorInicioEval.seleccionEvaluado(1)}"
                             update="pruebas"
                             oncomplete="PrimeFaces.Mobile.navigate('#pruebas', {transition: 'flip'}); return false;"/>
            <p:remoteCommand name="seleccionPrueba" actionListener="#{controladorEvaluacion.cargarPreguntas()}"
                             update="preguntas"
                             oncomplete="PrimeFaces.Mobile.navigate('#preguntas', {transition: 'flip'}); return false;"/>
            <p:remoteCommand name="seleccion" actionListener="#{controladorInicioEval.seleccion()}"/>
            <p:remoteCommand name="seleccionPd" actionListener="#{controladorPlanDesarrollo.seleccion()}"/>
            <p:remoteCommand name="cerrarSesion" actionListener="#{controladorIngreso.ingresar()}"/>

            <p:commandButton id="descargarReporte" actionListener="#{controladorInicioEval.descarga()}"
                             process="@this" ajax="false" style="visibility: hidden;"/>
            <p:remoteCommand name="pantallaDinamicaPlanDesa"
                             actionListener="#{controlNavegacion.pantallaDinamica('./Evaluador/planDesa.xhtml')}"
                             process="@this" update=":principalForm"/>
            <p:remoteCommand name="seleccionPlan" actionListener="#{controladorPlanDesarrollo.seleccionPlanDesa()}"
                             update="planDesa, planDesa:formulario2, bitacoras:formulario3, pageNuevaActividad:formNuevaActividad"
                             oncomplete="PrimeFaces.Mobile.navigate('#planDesa', {transition: 'flip'}); return false;"/>
            <p:remoteCommand name="seleccionBitacora" actionListener="#{controladorPlanDesarrollo.seleccionBitacoraMovil()}"
                             update="planDesa, planDesa:formulario2, bitacoras:formulario3, pageNuevaBitacora:formNuevaBitacora"
                             oncomplete="PrimeFaces.Mobile.navigate('#bitacoras', {transition: 'flip'}); return false;"/>
            <p:remoteCommand name="pantallaNuevaActividad"
                             oncomplete="PrimeFaces.Mobile.navigate('#pageNuevaActividad', {transition: 'flip'}); return false;"/>
            <p:remoteCommand name="pantallaNuevaBitacora"
                             oncomplete="PrimeFaces.Mobile.navigate('#pageNuevaBitacora', {transition: 'flip'}); return false;"/>
        </h:form>
        <pm:page id="uno">
            <h:form>
                <pm:header title="Modulo de evaluación DESIGNER" swatch="b"
                           styleClass="ui-header">
                    <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                    <p:tabMenu activeIndex="0">
                        <p:menuitem value="Inicio" icon="ui-icon-home" outcome="pm:uno?transition=flip" iconPos="top"/>
                        <p:menuitem value="Convocatorias" icon="ui-icon-gear" outcome="pm:convocatorias?transition=flip" iconPos="top"/>
                    </p:tabMenu>
                </pm:header>
                <pm:content>
                    <center> 
                        <h3>BIENVENIDO(A)</h3>
                        <h3 style="font-weight: bold; color: #08088A;"> #{controladorInformacionBasica.persona.nombreCompleto}</h3>
                        <h4>Número de identificación: #{controladorInformacionBasica.persona.numerodocumento}</h4>
                        <br/>
                        <br/>
                        <p:graphicImage value="#{controladorInformacionBasica.logoEmpresa}" alt="Logo empresa"
                                        cache="false" style="height: 91px;"/>
                        <br/>
                        <br/>
                        <h:outputText value="Estado" style="font-weight: bold"/>
                        <p:selectOneButton value="#{controladorInicioEval.estadoConvocatoria}">
                            <f:selectItem itemLabel="Alcance" itemValue="1" />
                            <f:selectItem itemLabel="Procesar" itemValue="2" />
                            <p:ajax update="convocatorias, @this"
                                    listener="#{controladorInicioEval.cargarConvocatorias()}"/>
                        </p:selectOneButton>
                    </center>
                </pm:content>
            </h:form>
        </pm:page>
        <pm:page id="convocatorias">
            <h:form>
                <pm:header title="Modulo de evaluación DESIGNER" swatch="b"
                           styleClass="ui-header">
                    <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                    <p:tabMenu activeIndex="1">
                        <p:menuitem value="Inicio" icon="ui-icon-home" outcome="pm:uno?transition=flip" iconPos="top"/>
                        <p:menuitem value="Convocatorias" icon="ui-icon-gear" outcome="pm:convocatorias?transition=flip" iconPos="top"/>
                    </p:tabMenu>
                </pm:header>

                <pm:content>
                    <p:dataList value="#{controladorInicioEval.convocatorias}" var="cv" rowIndexVar="indexC">
                        <h:outputLink value="#"
                                          onclick="seleccion([{name: 'valor', value:#{indexC}}, {name: 'tipo', value: '0'}]);">
                            <p>#{cv.codigo}</p>
                            <p><strong>Enfoque:</strong> #{cv.enfoque}</p>
                        </h:outputLink>
                        <p:commandButton value="Cerrar" onclick="seleccion([{name: 'valor', value:#{indexC}}, {name: 'tipo', value: '3'}]);"
                                         style="display: #{controladorInicioEval.estadoConvocatoria == 1 ? 'none' : ''}"/>
                        <p:commandButton value="Reporte" onclick="seleccion([{name: 'valor', value:#{indexC}}, {name: 'tipo', value: '4'}]);"
                                         style="display: #{controladorInicioEval.estadoConvocatoria == 1 ? '' : 'none'}"/>
                    </p:dataList>

                    <p:dialog id="alertaCC" header="Información" widgetVar="alertaCC"  resizable="false" 
                              draggable="false" modal="true" closable="false" closeOnEscape="true">  
                        <p:panelGrid styleClass="noBorders">
                            <p:column>
                                <h:outputText value="En el momento en que cierre el proceso de valoraciones a esta convocatoria, ya no podrá cambiar los datos."
                                              escape="false" style="text-align: justify"/>
                                <br/>
                                <br/>
                                <center>
                                    <h:outputText value="¿Está seguro(a) de cerrar el proceso?"
                                                  style="font-weight: bold"/>
                                </center>
                            </p:column>
                        </p:panelGrid>
                        <p:panelGrid columns="2" styleClass="noBorders">
                            <p:commandButton value="Si"
                                             actionListener="#{controladorInicioEval.cerrarConvocatoria()}"
                                             onclick="PF('alertaCC').hide();"
                                             process="@this"
                                             />
                            <p:commandButton value="No"
                                             onclick="PF('alertaCC').hide();"
                                             process="@this"/>
                        </p:panelGrid>
                    </p:dialog>

                    <p:dialog id="opcionesReporteCerrar" header="Información" widgetVar="opcionesReporteCerrar"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">  
                        <p:panelGrid columns="1" styleClass="noBorders">
                            <p:column>
                                <center><h:outputText value="¡Convocatoria cerrada con exito!" 
                                                      style="font-weight: bold; display: #{controladorInicioEval.estadoConvocatoria == 1 ? 'none' : ''}"/></center>
                                <br style="font-weight: bold; display: #{controladorInicioEval.estadoConvocatoria == 1 ? 'none' : ''}"/>
                                <h:outputText value="Por favor seleccione si quiere descargar o enviar por correo el reporte consolidado de la convocatoria que acabo de cerrar."
                                              escape="false" style="text-align: justify"/>
                                <br/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Enviar por correo" style="float: right"
                                                 actionListener="#{controladorInicioEval.envioCorreoCierreConvocatoria(1)}"
                                                 process="@this" onclick="PF('opcionesReporteCerrar').hide()"/>
                                <p:commandButton value="Descargar" style="float: right" 
                                                 actionListener="#{controladorInicioEval.descargarReporte(1)}"
                                                 process="@this" onclick="PF('opcionesReporteCerrar').hide(); "/>
                            </p:column>
                        </p:panelGrid>
                    </p:dialog>
                </pm:content>
            </h:form>
        </pm:page>

        <pm:page id="evaluados">
            <h:form>
                <pm:header title="Empleados a evaluar" swatch="b"
                           styleClass="ui-header">
                    <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                    <p:button styleClass="ui-btn-left ui-btn-inline" value="Volver" icon="ui-icon-arrow-l" outcome="pm:convocatorias?transition=flip"/>
                </pm:header>

                <pm:content>
                    <p:dataList value="#{controladorInicioEval.evaluados}" var="ev" rowIndexVar="indexE">
                        <h:outputLink value="#" onclick="seleccion([{name: 'valor', value:#{indexE}}, {name: 'tipo', value: '1'}]);">
                            <p>#{ev.nombrePersona}</p>
                            <p><strong>Puntaje: </strong>#{ev.puntajeObtenido != null ?
                                                           ev.puntajeObtenido : 0}</p>
                        </h:outputLink>
                        <p:commandButton value="Plan de desarrollo" onclick="seleccion([{name: 'valor', value:#{indexE}}, {name: 'tipo', value: '6'}]);"
                                         disabled="#{controladorInicioEval.esJefeInmediato(ev.secuencia)}"  rendered="#{controladorInicioEval.estadoConvocatoria == 1 ? 'true' : 'false'}"/>
                        <p:commandButton value="Reporte" onclick="seleccion([{name: 'valor', value:#{indexE}}, {name: 'tipo', value: '5'}]);"
                                         />
                        <hr/>

                    </p:dataList>

                    <p:dialog id="opcionesReporteEvaluado" header="Información" widgetVar="opcionesReporteEvaluado"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">  
                        <p:panelGrid columns="1" styleClass="noBorders">
                            <p:column>
                                <center><h:outputText value="Por favor seleccione el tipo de reporte que desea descargar."/></center>
                                <br/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Resumido" style="float: right;" 
                                                 process="@this" onclick="PF('opcionesReporteEvaluado').hide(); PF('opcionesReporteResumido').show()"
                                                 disabled="#{!evaluado.esConsolidado}"/>
                                <p:commandButton value="Consolidado" style="float: right;" 
                                                 process="@this" onclick="PF('opcionesReporteEvaluado').hide(); PF('opcionesReporteConsolidado').show()"
                                                 disabled="#{!evaluado.esConsolidado}"/>
                                <p:commandButton value="Evaluador" style="float: right;" 
                                                 process="@this" onclick="PF('opcionesReporteEvaluado').hide(); PF('opcionesReporteEvaluador').show()"/>
                            </p:column>
                        </p:panelGrid>
                    </p:dialog>

                    <p:dialog id="opcionesReporteEvaluador" header="Atención" widgetVar="opcionesReporteEvaluador"  resizable="false" 
                              draggable="false" modal="true" closable="false" closeOnEscape="true">  
                        <p:panelGrid columns="1" styleClass="noBorders">
                            <p:column>
                                <h:outputText value="Por favor seleccione si quiere descargar o enviar por correo el reporte por evaluador de la persona seleccionada."
                                              escape="false" style="text-align: justify"/>
                                <br/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Enviar por correo" style="float: right;"
                                                 actionListener="#{controladorInicioEval.envioCorreoCierreConvocatoria(2)}"
                                                 process="@this" onclick="PF('opcionesReporteEvaluador').hide();"/>
                                <p:commandButton value="Descargar" style="float: right;" 
                                                 actionListener="#{controladorInicioEval.descargarReporte(2)}"
                                                 process="@this" onclick="PF('opcionesReporteEvaluador').hide(); "/>
                            </p:column>
                        </p:panelGrid>
                    </p:dialog>
                    <p:dialog id="opcionesReporteResumido" header="Atención" widgetVar="opcionesReporteResumido" resizable="false" 
                              draggable="false" modal="true" closable="false" closeOnEscape="true">  
                        <p:panelGrid columns="1" styleClass="noBorders">
                            <p:column>
                                <h:outputText value="Por favor seleccione si quiere descargar o enviar por correo el reporte consolidado de la convocatoria cerrada."
                                              escape="false" style="text-align: justify"/>
                                <br/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Enviar por correo" style="float: right;"
                                                 actionListener="#{controladorInicioEval.envioCorreoCierreConvocatoria(4)}"
                                                 process="@this" onclick="PF('opcionesReporteResumido').hide()"/>
                                <p:commandButton value="Descargar" style="float: right;" 
                                                 actionListener="#{controladorInicioEval.descargarReporte(4)}" 
                                                 process="@this" onclick="PF('opcionesReporteResumido').hide(); "/>
                            </p:column>
                        </p:panelGrid>
                    </p:dialog>
                    <p:dialog id="opcionesReporteConsolidado" header="Atención" widgetVar="opcionesReporteConsolidado"  resizable="false" 
                              draggable="false" modal="true" closable="false" closeOnEscape="true">  
                        <p:panelGrid columns="1" styleClass="noBorders">
                            <p:column>
                                <h:outputText value="Por favor seleccione si quiere descargar o enviar por correo el reporte consolidado de la convocatoria cerrada."
                                              escape="false" style="text-align: justify"/>
                                <br/>
                            </p:column>
                            <p:column>
                                <p:commandButton value="Enviar por correo" style="float: right;"
                                                 actionListener="#{controladorInicioEval.envioCorreoCierreConvocatoria(3)}"
                                                 process="@this" onclick="PF('opcionesReporteConsolidado').hide()"/>
                                <p:commandButton value="Descargar" style="float: right;" 
                                                 actionListener="#{controladorInicioEval.descargarReporte(3)}"
                                                 process="@this" onclick="PF('opcionesReporteConsolidado').hide(); "/>
                            </p:column>
                        </p:panelGrid>
                    </p:dialog>
                    
                </pm:content>
            </h:form>
        </pm:page>

        <pm:page id="planDesa">
            <pm:header title="Plan de desarrollo" swatch="b"
                       styleClass="ui-header">
                <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                <p:button styleClass="ui-btn-left ui-btn-inline" value="Volver" icon="ui-icon-arrow-l" outcome="pm:evaluados?transition=flip" />
            </pm:header>
            <pm:content>
                <h:form id="formulario2">
                    <p:remoteCommand name="actualizaPlanes"
                                     process="@this" update="planDesa:formulario2" actionListener="#{controladorPlanDesarrollo.actualizaActividades()}"/>
                    <p:remoteCommand name="eliminarPlan" actionListener="#{controladorPlanDesarrollo.seleccionEliminarPlanMovil()}"
                                     process="@this" update="bitacoras:formulario3, panelInfoElimActividad, alertaInfoElimActividad"/>

                    <center><h3>PLAN DE DESARROLLO</h3></center>
                    <hr/>       
                    <p:panelGrid columns="2" styleClass="noBorders">
                        <h:outputText value="Nombre: " style="font-weight: bold; color: #122AB5"/>
                        <h:outputText value="#{controladorPlanDesarrollo.evaluadoActual.nombrePersona}"/>
                        <h:outputText value="Documento: " style="font-weight: bold; color: #122AB5"/>
                        <h:outputText value="#{controladorPlanDesarrollo.evaluadoActual.empleado}"/>
                        <h:outputText value="Puntaje obtenido: " style="font-weight: bold; color: #122AB5"/>
                        <h:outputText value="#{controladorPlanDesarrollo.evaluadoActual.puntajeObtenido==null?0:controladorPlanDesarrollo.evaluadoActual.puntajeObtenido}%" />                    
                    </p:panelGrid>
                    <hr/>
                    <p:column style="margin-top: 2%">      
                        <center>
                            <p:spacer height="20" width="20"/>
                            <p:commandButton value="Añadir Actividad" onclick="pantallaNuevaActividad()" actionListener="#{controladorPlanDesarrollo.actualizaListasMovil()}"
                                             style="font-size: 18px !important; background-color: #00FF00; color: black;" update="pageNuevaActividad:formNuevaActividad, planDesa"/>
                        </center>     

                    </p:column>
                    <p:dataList value="#{controladorPlanDesarrollo.planesDesarrollos}" var="ev" rowIndexVar="indexE">       
                        <h:outputLink value="#" onclick="seleccionPd([{name: 'valor', value:#{indexE}}, {name: 'tipo', value: '7'}]);">
                            <p><strong>Cod: </strong>#{ev.codigo != null ?
                                                       ev.codigo : 0}</p>
                            <p><strong>Actividad a desarrollar: </strong>#{ev.evalActividad.descripcion != null ?
                                                                           ev.evalActividad.descripcion : ''}</p>
                            <p><strong>Observación: </strong>#{ev.observacion != null ?
                                                               ev.observacion : ''}</p>
                            <p><strong>Profesión: </strong>#{ev.profesion.descripcion != null ?
                                                             ev.profesion.descripcion : 'N/A'}</p>
                            <p><strong>Curso: </strong>#{ev.curso.nombre != null ?
                                                            ev.curso.nombre : 'N/A'}</p>
                            <p><strong>Periodicidad seguimiento: </strong>#{ev.periodicidad != null ? ev.periodicidad : ''}</p>
                        </h:outputLink>
                        <p:commandButton value="Eliminar" onclick="eliminarPlan([{name: 'valor', value:#{indexE}}, {name: 'tipo', value: '8'}]);" />
                        <hr/>
                    </p:dataList>

                    <p:dialog id="alertaInfoElimActividad" header="Información" widgetVar="alertaInfoElimActividad"  resizable="false" style="width: 100%"
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                         <h:outputText id="valid1" rendered="#{controladorPlanDesarrollo.hasBitacoras()}" value="No es posible eliminar una actividad con bitácoras asignadas." style="width: 100%"/>
                          <h:outputText rendered="#{!controladorPlanDesarrollo.hasBitacoras()}" value="¿Está seguro que desea eliminar la actividad?" style="width: 100%"/>
                        <p:panelGrid columns="1" styleClass="noBorders" id="panelInfoElimActividad">
                            <p:commandButton value="Aceptar" rendered="#{controladorPlanDesarrollo.hasBitacoras()}"
                                             onclick="PF('alertaInfoElimActividad').hide();"
                                             process="@this"/>
                            <p:panelGrid columns="2" styleClass="noBorders">
                                <p:commandButton value="Si" rendered="#{!controladorPlanDesarrollo.hasBitacoras()}"
                                                 actionListener="#{controladorPlanDesarrollo.eliminarPlanDesarrolloMovil()}" process="@this"/>
                                <p:commandButton value="No" rendered="#{!controladorPlanDesarrollo.hasBitacoras()}"
                                                 onclick="PF('alertaInfoElimActividad').hide();" process="@this"/>
                            </p:panelGrid>
                        </p:panelGrid>
                    </p:dialog>
                    <p:dialog id="alertaActividadEliminada" header="Información" widgetVar="alertaActividadEliminada"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <h:outputText value="Actividad de plan de desarrollo eliminada exitosamente!"/>
                        <p:commandButton value="Aceptar"
                                         onclick="seleccionPlan()"
                                         process="@this"/>        
                    </p:dialog>
                    <p:dialog id="alertaActividadElimError" header="Información" widgetVar="alertaActividadElimError"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <h:outputText value="No fue posible eliminar la actividad de plan de desarrollo. Inténtelo nuevamente."/>
                        <p:commandButton value="Aceptar"
                                         onclick="seleccionPlan()"
                                         process="@this"/>        
                    </p:dialog>
                </h:form>
            </pm:content>
        </pm:page>        
        
        <pm:page id="pruebas">
            <pm:header title="Pruebas" swatch="b"
                       styleClass="ui-header">
                <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                <p:button styleClass="ui-btn-left ui-btn-inline" value="Volver" icon="ui-icon-arrow-l" outcome="pm:evaluados?transition=flip"/>
            </pm:header>

            <h:form id="formulario1">
                <pm:content>
                    <p:dataList value="#{controladorInicioEval.pruebas}" var="prb" rowIndexVar="indexP">
                        <h:outputLink value="#" onclick="seleccion([{name: 'valor', value:#{indexP}}, {name: 'tipo', value: '2'}]);"
                                      >
                            <p>#{prb.prueba}</p>
                            <p><strong>Factor: </strong>#{prb.factor}</p>
                            <p><strong>Obsv: </strong>#{prb.obsEvaluador}</p>
                            <p><strong>#{prb.puntoObtenido != null ?
                                         prb.puntoObtenido : 0}%</strong></p>
                        </h:outputLink>
                        <p:panelGrid columns="5">
                            <p:column>
                                <br style="display: #{controladorInicioEval.estadoConvocatoria == 1 ? 'none' : ''}"/>
                                <h:outputText value=" Estado:" style="font-weight: bold"/>
                            </p:column>
                            <p:column>
                                <div style="display: #{controladorInicioEval.estadoConvocatoria == 1 ? 'none' : ''}">
                                    <p:selectOneMenu value="#{prb.estado}" >
                                        <f:selectItem itemLabel="A" itemValue="A" />
                                        <f:selectItem itemLabel="C" itemValue="C" />
                                        <p:ajax listener="#{controladorInicioEval.cambiarEstadoMobil(indexP)}"/>
                                    </p:selectOneMenu>
                                </div>
                                <center><h:outputText value="#{prb.estado}" style="display: #{controladorInicioEval.estadoConvocatoria == 1 ? '' : 'none'}"/></center>
                            </p:column>
                            <p:column/>
                            <p:column/>
                            <p:column/>
                        </p:panelGrid>
                    </p:dataList>
                </pm:content>
            </h:form>
        </pm:page>

        <pm:page id="preguntas">
            <pm:header title="Preguntas" swatch="b"
                       styleClass="ui-header">
                <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                <p:button styleClass="ui-btn-left ui-btn-inline" value="Volver" icon="ui-icon-arrow-l" outcome="pm:pruebas?transition=flip"
                          onclick="refrescarListas();"/>
            </pm:header>
            <h:form id="formulario">
                <pm:content>
                    <p:growl id="growl" widgetVar="growl" showDetail="true" autoUpdate="true"/>
                    <p:remoteCommand name="actualizarScore" actionListener="#{controladorEvaluacion.calcularPuntajePorcentaje()}"
                                     process="@this" update="evaluacion:score"/>
                    <p:remoteCommand name="refrescarListas" actionListener="#{controladorInicioEval.refrescarListas()}"
                                     process="@this" update=":pruebas:formulario1"/>
                    <p:panel header="Información">
                        <center>
                            <h:outputText value="Nombre" style="font-weight: bold; color: #122AB5"/>
                            <br/>
                            <h:outputText value="#{controladorEvaluacion.evaluado}"
                                          style="font-weight: bold;"/>
                            <br/>
                            <h:outputText value="Nro. Preguntas" style="font-weight: bold; color: #122AB5"/>
                            <br/>
                            <h:outputText value="#{controladorEvaluacion.nroPreguntas}"
                                          style="font-weight: bold;"/>
                            <br/>
                            <h:outputText value="Convocatoria" style="font-weight: bold; color: #122AB5"/>
                            <br/>
                            <h:outputText value="#{controladorEvaluacion.convocatoria}"
                                          style="font-weight: bold;"/>
                            <br/>
                            <h:outputText value="Evaluador" style="font-weight: bold; color: #122AB5"/>
                            <br/>
                            <h:outputText value="#{controladorEvaluacion.evaluador}"
                                          style="font-weight: bold;"/>
                            <br/>
                            <h:outputText value="Puntaje maximo" style="font-weight: bold; color: #122AB5"/>
                            <br/>
                            <p:column/>
                            <br/>
                            <h:outputText value="Prueba" style="font-weight: bold; color: #122AB5"/>
                            <br/>
                            <h:outputText value="#{controladorEvaluacion.prueba}"
                                          style="font-weight: bold;"/>
                        </center>
                        <center><p:commandButton value="Eliminar todas las respuestas" onclick="PF('alertaEliminar').show();"
                                                 process="@this"
                                                 style="display: #{controladorInicioEval.estadoConvocatoria == 1 ? 'none' : 
                                                                   controladorEvaluacion.pruebaActual.estado == 'C' ? 'none' :
                                                                   controladorEvaluacion.tieneRespuestas ? '' : 'none'}"/></center>
                    </p:panel>
                    <h:form id="evaluacion">
                        <p:panel header="Evaluación">
                            <ui:repeat var="pregunta" value="#{controladorEvaluacion.preguntas}" varStatus="status">
                                <div style="background-color: #{pregunta.respuesta == null ? '#F8B7B7' : '#B7F8BE'}">
                                    <h:outputText value="#{pregunta.descripcion}"
                                                  style="font-weight: bold"/>
                                </div>
                                <p:selectOneRadio value="#{pregunta.respuesta}" 
                                                  disabled="#{controladorInicioEval.estadoConvocatoria == 1 ? 'true' : 
                                                              controladorEvaluacion.pruebaActual.estado == 'C' ? 'true' : 'false'}">
                                    <f:selectItems value="#{pregunta.respuestas}" var="r" 
                                                   itemLabel=" #{r.cuantitativo} - #{r.cualitativo}" 
                                                   itemValue="#{r.secuencia}"/>
                                    <p:ajax update=":preguntas:formulario" process="@this" oncomplete="actualizarScore();"/>
                                </p:selectOneRadio> 
                                <br/>
                            </ui:repeat>

                            <h:outputText value="Observación:" style="font-weight: bold"/>
                            <br/>
                            <p:inputTextarea value="#{controladorEvaluacion.observacionEvaluador}">
                                <p:ajax update="@this"/>
                            </p:inputTextarea>
                            <br/>

                            <center>
                                <p:panelGrid id="score" columns="4" styleClass="noBorders">
                                    <h:outputText value="Puntaje: " style="font-weight: bold; color: #122AB5"/>
                                    <h:outputText value="#{controladorEvaluacion.puntaje}"
                                                  style="font-weight: bold;"/>
                                    <h:outputText value="Porcentaje: " style="font-weight: bold; color: #122AB5"/>
                                    <h:outputText value="#{controladorEvaluacion.porcentaje}%"
                                                  style="font-weight: bold;"/>
                                </p:panelGrid>
                            </center>
                            <br/>

                            <center><p:commandButton value="Enviar" onclick="PF('alerta').show();"
                                                     process="@this" 
                                                     style="font-size: 18px; 
                                                     display: #{controladorInicioEval.estadoConvocatoria == 1 ? 'none' : 
                                                                controladorEvaluacion.pruebaActual.estado == 'C' ? 'none' : ''}"/>
                            </center>
                        </p:panel>
                    </h:form>
                    <p:dialog id="alerta" header="Información" widgetVar="alerta"  resizable="false" 
                              draggable="false" modal="true" closable="false" closeOnEscape="true">  
                        <p:panelGrid styleClass="noBorders">
                            <p:column>
                                <center>
                                    <h:outputText value="¿Esta seguro(a) de que desea enviar la evaluación?"/>
                                </center>
                            </p:column>
                        </p:panelGrid>
                        <p:panelGrid columns="2" styleClass="noBorders">
                            <p:commandButton value="Si"
                                             actionListener="#{controladorEvaluacion.enviarRespuestas()}"
                                             onclick="PF('alerta').hide();"
                                             process="@this"/>
                            <p:commandButton value="No"
                                             onclick="PF('alerta').hide();"
                                             process="@this"/>
                        </p:panelGrid>
                    </p:dialog>

                    <p:dialog id="alertaEliminar" header="Atención" widgetVar="alertaEliminar"  resizable="false" 
                              draggable="false" modal="true" closable="false" closeOnEscape="true">  
                        <p:panelGrid columns="1" styleClass="noBorders">
                            <p:column>
                                <center>
                                    <h:outputText value="¿Esta seguro(a) de que desea eliminar todas las respuestas?"/>
                                </center>
                            </p:column>
                        </p:panelGrid>
                        <p:panelGrid columns="2" styleClass="noBorders">
                            <p:commandButton value="Si" 
                                             actionListener="#{controladorEvaluacion.eliminarRespuestas()}"
                                             update=":preguntas:formulario"
                                             onclick="PF('alertaEliminar').hide();"
                                             process="@this" />
                            <p:commandButton value="No"
                                             onclick="PF('alertaEliminar').hide();"
                                             process="@this"/>
                        </p:panelGrid>
                    </p:dialog>

                    <p:dialog id="envioExitoso" header="Información" widgetVar="envioExitoso"  resizable="false" 
                              draggable="false" modal="true" closable="false" closeOnEscape="true">  
                        <p:panelGrid columns="1" styleClass="noBorders">
                            <p:column>
                                <center>
                                    <h:outputText value="Respuestas enviadas con éxito."/>
                                </center>
                            </p:column>
                            <p:column>
                                <center>
                                    <p:button value="Volver" outcome="pm:pruebas?transition=flip"
                                              onclick="refrescarListas(); PF('envioExitoso').hide();"/>
                                </center>
                            </p:column>
                        </p:panelGrid>
                    </p:dialog>
                </pm:content>
            </h:form>
        </pm:page>
        
        <pm:page id="bitacoras">
            <pm:header title="Bitácoras" swatch="b"
                       styleClass="ui-header">
                <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                <p:button styleClass="ui-btn-left ui-btn-inline" value="Volver" icon="ui-icon-arrow-l" outcome="pm:planDesa?transition=flip"/>
            </pm:header>

            <h:form id="formulario3">
                <p:remoteCommand name="eliminarBitacora" actionListener="#{controladorPlanDesarrollo.seleccionaBitacoraMovil()}"
                                 process="@this" update="bitacoras:formulario3"/>
                <p:remoteCommand name="actualizaBitacoras"
                                 process="@this" update="bitacoras:formulario3" actionListener="#{controladorPlanDesarrollo.actualizaListasBitacora()}"/>
                <pm:content>
                    <p:column>      
                        <center>
                            <p:spacer height="20" width="20"/>
                            <p:commandButton value="Añadir Bitácora" onclick="pantallaNuevaBitacora()" actionListener="#{controladorPlanDesarrollo.actualizaListasBitacora()}"
                                             style="font-size: 18px !important; background-color: #00FF00; color: black;" update="pageNuevaBitacora:formNuevaBitacora"/>
                        </center>     

                    </p:column>
                    <p:dataList value="#{controladorPlanDesarrollo.bitacoras}" var="bit" rowIndexVar="indexP">
                        <h:outputLink value="#">
                            <p><strong>Fecha seguimiento: </strong>
                                <h:outputText value="#{bit.fecha}">
                                    <f:convertDateTime pattern="dd/MM/yyyy" />
                                </h:outputText></p>
                            <p><strong>Porcentaje alcanzado: </strong>#{bit.porcentaje != null ?
                                                                        bit.porcentaje : '0'}%</p>
                            <p><strong>Aprendizaje obtenido: </strong>#{bit.comentario != null ?
                                                                        bit.comentario : ''}</p>
                            </h:outputLink>
                            <p:panelGrid columns="2" styleClass="noBorders"> 
                                <p:commandButton value="Eliminar" onclick="eliminarBitacora([{name: 'valor', value:#{indexP}}, {name: 'tipo', value: '9'}])"/>
                                <p:commandButton value="Editar" onclick="eliminarBitacora([{name: 'valor', value:#{indexP}}, {name: 'tipo', value: '10'}]);" 
                                       update="pageNuevaBitacora:formNuevaBitacora"/>
                            </p:panelGrid>

                        
                    </p:dataList>
                    <p:dialog id="alertaInfoElimBitacora" header="Información" widgetVar="alertaInfoElimBitacora"  resizable="false" style="width: 100%"
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <h:outputText value="¿Está seguro que desea eliminar la bitácora?" style="width: 100%"/>
                        <p:panelGrid columns="2" styleClass="noBorders">
                                <p:commandButton value="Si"
                                                 actionListener="#{controladorPlanDesarrollo.eliminarBitacoraMovil()}" process="@this"/>
                                <p:commandButton value="No"
                                                 onclick="PF('alertaInfoElimBitacora').hide();" process="@this"/>
                        </p:panelGrid>
                    </p:dialog>
                </pm:content>
                
                <p:dialog id="alertaBitacoraEliminada" header="Información" widgetVar="alertaBitacoraEliminada"  resizable="false" 
                          draggable="false" modal="true" closable="true" closeOnEscape="true">
                    <h:outputText value="Bitácora eliminada exitosamente!"/>
                    <p:commandButton value="Aceptar" onclick="seleccionBitacora()" process="@this"/>        
                </p:dialog>
                <p:dialog id="alertaBitacoraElimError" header="Información" widgetVar="alertaActividadElimError"  resizable="false" 
                          draggable="false" modal="true" closable="true" closeOnEscape="true">
                    <h:outputText value="No fue posible eliminar la bitácora. Inténtelo nuevamente."/>
                    <p:commandButton value="Aceptar" onclick="seleccionBitacora()" process="@this"/>        
                </p:dialog>
            </h:form>   
        </pm:page>
        
        <pm:page id="pageNuevaBitacora">
            <pm:header title="Bitácora" swatch="b"
                       styleClass="ui-header">
                <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                <p:button styleClass="ui-btn-left ui-btn-inline" value="Volver" icon="ui-icon-arrow-l" outcome="pm:bitacoras?transition=flip"/>
            </pm:header>
            <pm:content>
                <h:form id="formNuevaBitacora">
                    <h4 style="font-weight: bold">#{controladorPlanDesarrollo.opcBitacora == 0 ? 'Nueva Bitácora.': 'Editar Bitácora.'} </h4>
             
                    <p:panelGrid columns="2">
                        <h:outputText value="Fecha de seguimiento" />
                        <p:calendar id="finicialdisMovil" style="width: 120px" size="10"
                                    value="#{controladorPlanDesarrollo.fechaseg}" readonlyInput="true" 
                                    pattern="dd/MM/yyyy" mask="true" locale="es" showOn="button"    >
                            <p:ajax event="dateSelect" listener="#{controladorPlanDesarrollo.onDateSelect}"/>
                        </p:calendar>

                        <p:outputLabel value="Porcentaje obtenido:"  />
                        <p:spinner id="porcentajeMovil" min="0" max="100" value="#{controladorPlanDesarrollo.porcent}" stepFactor="10" suffix="%" size="3">
                            <p:ajax process="@this"/>
                        </p:spinner>   
                        <h:outputText value="Aprendizaje adquirido (Máx 500 carácteres):" />
                        <h:inputTextarea value="#{controladorPlanDesarrollo.comentario}" id="comentarioMovil" rows="6" style="width: 98%">
                            <p:ajax process="@this"/>
                        </h:inputTextarea>
                    </p:panelGrid>
                    <p:panelGrid columns="1" styleClass="noBorders">     
                        <p:commandButton value="Registrar" rendered="#{controladorPlanDesarrollo.opcBitacora == 0 ? true: false}" 
                                     process="@this"
                                     onclick="PF('alertaInfoBitacora').show();" update="panelNuevaBitacoraMovil" />
                        <p:commandButton value="Guardar Cambios" rendered="#{controladorPlanDesarrollo.opcBitacora == 0 ? false: true}" 
                                     process="@this"
                                     onclick="PF('alertaInfoEditarBitacora').show();" update="panelEditarBitacoraMovil" />
                  <!--  <p:commandButton value="Cancelar" onclick="seleccionBitacora()"
                                         process="@this" style="font-size: 18px !important; background-color: #3388D7; color: white;" />-->
                    </p:panelGrid>
                    <p:dialog id="alertaInfoBitacora" header="Información" widgetVar="alertaInfoBitacora"  resizable="false" style="width: 100%; text-align: center" styleClass="width100"
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <p:panelGrid columns="1" styleClass="noBorders, width100" id="panelNuevaBitacoraMovil" style="width: 100%; text-align: center;">
                            <h:outputText rendered="#{!controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}" value="#{controladorPlanDesarrollo.msj}" style="width: 100%; text-align: center;" styleClass="width100"/>
                            <h:outputText rendered="#{controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}" value="Se dispone a registrar una nueva bitácora." style="width: 100%; text-align: center;" />
                            <p:commandButton value="Aceptar" id="btnNBitAcep" rendered="#{!controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}"
                                             onclick="PF('alertaInfoBitacora').hide();" update="panelNuevaBitacoraMovil"
                                             process="@this"/>
                            <p:commandButton value="Registrar" id="btnNBitG" rendered="#{controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}"
                                             actionListener="#{controladorPlanDesarrollo.registrarBitacoraMovil()}"
                                             process="@this"/>
                        </p:panelGrid>
                    </p:dialog>
                    <p:dialog id="alertaInfoEditarBitacora" header="Información" widgetVar="alertaInfoEditarBitacora"  resizable="false" style="width: 100%; text-align: center" styleClass="width100"
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <p:panelGrid columns="1" styleClass="noBorders" id="panelEditarBitacoraMovil">
                            <h:outputText rendered="#{!controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}" value="#{controladorPlanDesarrollo.msj}" style="width: 100%; text-align: center"/>
                            <h:outputText rendered="#{controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}" value="Se dispone a guardar cambios en una bitácora." style="width: 100%; text-align: center"/>
                            <p:commandButton value="Aceptar" id="btnEBitAcep" rendered="#{!controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}"
                                             onclick="PF('alertaInfoEditarBitacora').hide();"
                                             process="@this"/>
                            <p:commandButton value="Guardar" id="btnEBitG" rendered="#{controladorPlanDesarrollo.validacionNuevaBitacoraMovil()}"
                                             actionListener="#{controladorPlanDesarrollo.editarBitacoraMovil()}"
                                             process="@this"/>
                        </p:panelGrid>
                    </p:dialog>
                    <p:dialog id="alertaBitacoraCreada" header="Información" widgetVar="alertaBitacoraCreada"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <h:outputText value="Bitácora creada exitosamente!"/>
                        <p:commandButton value="Aceptar"
                                         onclick="seleccionBitacora()"
                                         process="@this"/>        
                    </p:dialog>
                    <p:dialog id="alertaBitacoraError" header="Información" widgetVar="alertaBitacoraError"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <h:outputText value="No fue posible crear la bitácora. Inténtelo nuevamente."/>
                        <p:commandButton value="Aceptar"
                                         onclick="seleccionBitacora()"
                                         process="@this"/>        
                    </p:dialog>
                    <p:dialog id="alertaBitacoraEditada" header="Información" widgetVar="alertaBitacoraEditada"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <h:outputText value="Se guardaron los cambios en la bitácora exitosamente!"/>
                        <p:commandButton value="Aceptar"
                                         onclick="seleccionBitacora()"
                                         process="@this"/>        
                    </p:dialog>
                    <p:dialog id="alertaBitacoraEditadaError" header="Información" widgetVar="alertaBitacoraEditadaError"  resizable="false" 
                              draggable="false" modal="true" closable="true" closeOnEscape="true">
                        <h:outputText value="No fue posible guardar los cambios en la bitácora. Inténtelo nuevamente."/>
                        <p:commandButton value="Aceptar"
                                         onclick="seleccionBitacora()"
                                         process="@this"/>        
                    </p:dialog>
                </h:form>
            </pm:content>
        </pm:page>
        
        <pm:page id="pageNuevaActividad">
            <pm:header title="Nueva Actividad" swatch="b"
                       styleClass="ui-header">
                <p:button styleClass="ui-btn-right ui-btn-inline" value="Salir" onclick="cerrarSesion();"/>
                <p:button styleClass="ui-btn-left ui-btn-inline" value="Volver" icon="ui-icon-arrow-l" outcome="pm:planDesa?transition=flip"/>
            </pm:header>
        <pm:content>
            <h:form id="formNuevaActividad">
                <p style="margin-top:0;"><b>Observación: </b>Si selecciona CAPACITACION FORMAL o NO FORMAL debe seleccionar un curso 
                    correspondiente ó escribir una observación. Si selecciona otro tipo de actividad debe colocar una observación.</p>
                <p:panelGrid columns="2" styleClass="noBorders" id="alertaNewActPanelMovil">
                    <h:outputText value="Código:" id="codMovil" />
                    <p:inputText value="#{controladorPlanDesarrollo.codigo}" disabled="true"/>
                    <h:outputText value="Actividad a desarrollar:*" id="selectActividadMovil" />
                    <p:selectOneMenu value="#{controladorPlanDesarrollo.actividadSelec}" >
                        <f:selectItem itemLabel="Seleccione una actividad" itemValue="#{null}" noSelectionOption="true"/>
                        <f:selectItems value="#{controladorPlanDesarrollo.actividades}" var="actividad" itemLabel="#{actividad.descripcion}" itemValue="#{actividad.secuencia}" />
                        <p:ajax event="change" listener="#{controladorPlanDesarrollo.procesarActividadSelecMovil()}" update="selectprofesionesMovil, selectcursosMovil"/>
                    </p:selectOneMenu>
                    <h:outputText value="Observación" />
                    <p:inputTextarea rows="6" cols="51" id="obsMovil" value="#{controladorPlanDesarrollo.observacion}" maxlength="500">
                        <p:ajax process="@this"/>
                    </p:inputTextarea> 
                    <h:outputText value="Educación Formal:" id="selectprofesionesMovil" />
                    <p:selectOneMenu value="#{controladorPlanDesarrollo.secProfesion}" id="profesionMovil">
                        <f:selectItem itemLabel="Seleccione una profesion:" itemValue="#{null}" noSelectionOption="true"/>
                        <f:selectItems value="#{controladorPlanDesarrollo.listaProfesiones}" var="profesion" itemLabel="#{profesion.descripcion}" itemValue="#{profesion.secuencia}" />
                        <p:ajax process="@this"/>
                    </p:selectOneMenu>
                    <h:outputText value="Educación No Formal:" id="selectcursosMovil" />
                    <p:selectOneMenu value="#{controladorPlanDesarrollo.secCurso}">
                        <f:selectItem itemLabel="Seleccione un curso" itemValue="#{null}"/>
                        <f:selectItems value="#{controladorPlanDesarrollo.cursos}" var="curso" itemLabel="#{curso.nombre}" itemValue="#{curso.secuencia}" />
                        <p:ajax process="@this"/>
                    </p:selectOneMenu>
                    <h:outputText value="Periodicidad seguimiento:" />
                    <p:selectOneMenu value="#{controladorPlanDesarrollo.periodicidad}">
                        <f:selectItem itemLabel="TRES MESES" itemValue="TRES MESES"/>
                        <f:selectItem itemLabel="SEIS MESES" itemValue="SEIS MESES" />
                        <f:selectItem itemLabel="1 AÑO" itemValue="1 AÑO" />
                        <p:ajax process="@this"/>
                        <p:ajax event="change" listener="#{controladorPlanDesarrollo.procesarActividadSelecMovil()}"/>
                    </p:selectOneMenu>

                </p:panelGrid>
                <p:panelGrid columns="1" styleClass="noBorders">     
                    <p:commandButton value="Guardar" 
                                     process="@this"
                                     onclick="PF('alertaInfoActividad').show();" update="panelNuevaActividadMovil" />
                <!--    <p:commandButton value="Cancelar" onclick="seleccionPlan()"
                                     process="@this" />-->
                </p:panelGrid>
                <p:dialog id="alertaInfoActividad" header="Información" widgetVar="alertaInfoActividad"  resizable="false" style="width: 100%; text-align: center"
                          draggable="false" modal="true" closable="true" closeOnEscape="true">
                    <p:panelGrid columns="1" styleClass="noBorders" id="panelNuevaActividadMovil">
                        <h:outputText rendered="#{controladorPlanDesarrollo.actividadSelec==null || controladorPlanDesarrollo.actividadSelec==''}" value="Seleccione una actividad" style="width: 100%; text-align: center"/>
                        <h:outputText rendered="#{controladorPlanDesarrollo.validacionNuevaActividadMovil()}" value="Se dispone a añadir una nueva actividad para #{controladorPlanDesarrollo.evaluadoActual.nombrePersona}" style="width: 100%; text-align: center"/>
                        <h:outputText rendered="#{controladorPlanDesarrollo.actividadSelec!=null}" value="#{controladorPlanDesarrollo.msj}" style="width: 100%; text-align: center"/>
                        <p:commandButton value="Aceptar" rendered="#{!controladorPlanDesarrollo.validacionNuevaActividadMovil()}"
                                         onclick="PF('alertaInfoActividad').hide();"
                                         process="@this"/>
                        <p:commandButton value="Guardar" rendered="#{controladorPlanDesarrollo.validacionNuevaActividadMovil()}"
                                         actionListener="#{controladorPlanDesarrollo.registrarPlanDesarrolloMovil()}"
                                         process="@this"/>
                    </p:panelGrid>
                </p:dialog>
                <p:dialog id="alertaActividadCreada" header="Información" widgetVar="alertaActividadCreada"  resizable="false" 
                          draggable="false" modal="true" closable="true" closeOnEscape="true">
                    <h:outputText value="Actividad de plan de desarrollo creada exitosamente"/>
                    <p:commandButton value="Aceptar" onclick="seleccionPlan()" process="@this"/>        
                </p:dialog>
                <p:dialog id="alertaActividadError" header="Información" widgetVar="alertaActividadError"  resizable="false" 
                          draggable="false" modal="true" closable="true" closeOnEscape="true">
                    <h:outputText value="No fue posible crear la actividad de plan de desarrollo. Inténtelo nuevamente."/>
                    <p:commandButton value="Aceptar" onclick="seleccionPlan()" process="@this"/>        
                </p:dialog>
                
            </h:form>

        </pm:content>
        </pm:page>
                    

    </h:body>

</html>